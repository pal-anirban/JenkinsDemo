pipeline {
    agent any
    environment { 
    	GITUrl = 'https://github.com/pal-anirban/time-tracker.git'
        TomcatPath = 'C:/External Software/apache-tomcat-9.0.46-windows-x64/apache-tomcat-9.0.46'
        Tomcat_Login = 'jenkinsJenkinsMS'
        Tomcat_URL = 'http://localhost:8081/'
    }
    stages {
        stage('Checkout') {
            steps {
                git branch: 'main', url: GITUrl
            }
        }
 		stage("Build") {
			steps {
				bat "mvn clean test package"
			}
			post {
			    always { 
           			 echo 'Build step executed'
       			 }
                success {
                	echo 'Build Successful'
                    archiveArtifacts 'target/*.war'        
                }   
            }       
		}
		stage('Tomcat Deployment') {
            steps {
               	deploy adapters: [tomcat9(credentialsId: Tomcat_Login, path: '', url: Tomcat_URL)], contextPath: 'TimeTracker', onFailure: false, war: '**/*.war'
            }

            post {
                  always { 
           			 echo 'Deployment step executed'
       			 }
                success {
                	echo 'Deployment Successful'
                }
                
            }
        }
    }
}
